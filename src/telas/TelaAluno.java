/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JFrame.java to edit this template
 */
package telas;

import classes.Aluno;
import classes.Avaliacao;
import classes.Professor;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.List;
import javax.swing.DefaultComboBoxModel;
import javax.swing.JOptionPane;
import javax.swing.table.DefaultTableModel;
import model.dao.AlunoDAO;
import model.dao.AvaliacaoDAO;


/**
 *
 * @author limaa
 */
public class TelaAluno extends javax.swing.JFrame{
    
    private Aluno aluno;
    ArrayList<Integer> listaAvaliacoes = new ArrayList<>();
    String[] listaDepartamentos = new String []{"Departamento de Ciência da Computação","Departamento de Matemática", "Departamento de História",
                                                "Departamento de Estatística","Departamento de Administração", "Departamento de Medicina", 
                                                "Faculdade de Direito", "Departamento de Física", "Departamento de Filosofia","Instituto de Relações Internacionais",
                                                "Departamento de Geografia","Departamento de Economia","Departamento de Psicologia", "Departamento de Química"
                                                };
    String[] listaCursos = new String []{"Ciência da Computação","Matemática", "História","Estatística","Administração", "Medicina", "Direito", "Física", 
                                            "Filosofia","Relações Internacionais","Geografia","Economia","Psicologia", "Química"
                                        };

    /**
     * Creates new form TelaAluno
     */
    //static ArrayList<Avaliacao> listaAvaliacao;
    
    public TelaAluno() {
        //int indiceProfessor;
        //boolean chamaProfessor = false;
        //inicializa os componentes da tela, limpa os campos e habilita ou desabilita campos de texto e botoes
        initComponents();
        this.limpar();
        this.habilitarBtn(true, true, false, false, false, true, true);
        this.habilitarTexto(false, false, false, false, false, false);
        //listaAvaliacao = new ArrayList();
        this.carregarComboBoxDepartamentos();
        this.carregarComboBoxCursos();
        this.carregarTabelaAvaliacao();
       
        
    }
    
    public TelaAluno(Aluno aluno){
        //int indiceProfessor;
        //boolean chamaProfessor = false;
        //inicializa os componentes da tela, limpa os campos e habilita ou desabilita campos de texto e botoes
        initComponents();
        this.limpar();
        this.habilitarBtn(true, true, false, false, true, true, true);
        this.habilitarTexto(false, false, false, false, false, false);
        this.aluno = aluno;
        //listaAvaliacao = new ArrayList();
        this.carregarComboBoxDepartamentos();
        this.carregarComboBoxCursos();
        this.carregarTabelaAvaliacao();       
         
    }

    public Aluno getAluno() {
        return this.aluno;
    }

    public void setAluno(Aluno aluno) {
        this.aluno = aluno;
    }
    
    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    private int achaDepartamento(String valor){
        for (int i=0; i<listaDepartamentos.length;i++){
            if (valor.equals(listaDepartamentos[i])){
                return i+1;
            }
        }
        return -1;
    }
    
    private int achaCurso(String valor){
        for (int i=0; i<listaCursos.length;i++){
            if (valor.equals(listaCursos[i])){
                return i+1;
            }
        }
        return -1;
    }
    private void carregarComboBoxDepartamentos(){
        DefaultComboBoxModel modelo = new DefaultComboBoxModel();
        modelo.addElement("Selecione um departamento");
        Arrays.sort(this.listaDepartamentos);
        for (String departamento : this.listaDepartamentos){
            modelo.addElement(departamento);
        }
        this.cmbDepartamento.setModel(modelo);
    }
    
    private void carregarComboBoxCursos(){
        DefaultComboBoxModel modelo = new DefaultComboBoxModel();
        modelo.addElement("Selecione um curso");
        Arrays.sort(this.listaCursos);
        for (String curso : this.listaCursos){
            modelo.addElement(curso);
        }
        this.cmbCurso.setModel(modelo);
    }
    
    private void carregarTabelaAvaliacao(){
        DefaultTableModel modelo = new DefaultTableModel(new Object[] {"ID", "Professor (a)", "Feedback", "Nota"},0){
            @Override
            public boolean isCellEditable(int row, int column) {
                return false;
            }
        };
        AlunoDAO dao = new AlunoDAO();
       
        List <Avaliacao> listaAvaliacao = dao.agrupAvaliacao(this.aluno).getAvaliacoes();         
        modelo.setNumRows(0);
        for(Avaliacao avalia: listaAvaliacao){
            if (!this.listaAvaliacoes.contains(avalia.getId())){
                modelo.addRow(new Object[]{
                    avalia.getId(),
                    avalia.getProfessor().getNome(),
                    avalia.getFeedback(), 
                    avalia.getNota(),
                });
            listaAvaliacoes.add(avalia.getId());
            }
        }
        
        tblAvaliacoes.setModel(modelo);
        
        tblAvaliacoes.getColumnModel().getColumn(0).setMinWidth(0); // ID escondido
        tblAvaliacoes.getColumnModel().getColumn(0).setMaxWidth(0); // ID escondido
        tblAvaliacoes.getColumnModel().getColumn(0).setPreferredWidth(0); // ID escondido
        tblAvaliacoes.getColumnModel().getColumn(1).setPreferredWidth(50);
        tblAvaliacoes.getColumnModel().getColumn(2).setPreferredWidth(50);
        tblAvaliacoes.getColumnModel().getColumn(3).setPreferredWidth(10);   
    } 
    
    private void habilitarTexto(boolean nome, boolean departamento,boolean email,boolean matricula, boolean curso, boolean senha){ //metodo para habilitar campos de texto
        this.txtNome.setEnabled(nome);
        this.cmbDepartamento.setEnabled(departamento);
        this.txtEmail.setEnabled(email);
        this.txtMatricula.setEnabled(matricula);
        this.cmbCurso.setEnabled(curso);
        this.txtSenha.setEnabled(senha);
    }
    
    private void habilitarBtn(boolean novaAvaliacao, boolean editar, boolean cancelar, boolean salvarEdicao, boolean excluir,boolean editarPerfil, boolean editarAvaliacao){ //metodo para habilitar botoes
        this.btnNovaAvaliacao.setEnabled(novaAvaliacao);
        this.btnEditar.setEnabled(editar);
        this.btnCancelar.setEnabled(cancelar);
        this.btnSalvarEdicao.setEnabled(salvarEdicao);
        this.btnExcluir.setEnabled(excluir);
        this.btnEditar.setVisible(editarPerfil);
        this.btnEditAvaliacao.setVisible(editarAvaliacao);
        //this.btnEditar.setEnabled(editar);
    }
    
    private void limpar(){ //metodo para limpar campos de texto
        this.txtNome.setText("");
        this.cmbDepartamento.setSelectedIndex(0);
        this.txtEmail.setText("");
        this.txtMatricula.setText("");
        this.cmbCurso.setSelectedIndex(0);
        this.txtSenha.setText("");
    
    }
    
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPasswordField1 = new javax.swing.JPasswordField();
        jPanel1 = new javax.swing.JPanel();
        jLabel1 = new javax.swing.JLabel();
        lblNome = new javax.swing.JLabel();
        lblCurso = new javax.swing.JLabel();
        lblMatricula = new javax.swing.JLabel();
        txtNome = new javax.swing.JTextField();
        txtMatricula = new javax.swing.JTextField();
        btnEditar = new javax.swing.JButton();
        btnCancelar = new javax.swing.JButton();
        btnSalvarEdicao = new javax.swing.JButton();
        btnNovaAvaliacao = new javax.swing.JButton();
        txtDepartamento = new javax.swing.JLabel();
        txtEmail = new javax.swing.JTextField();
        lblEmail = new javax.swing.JLabel();
        lblSenha = new javax.swing.JLabel();
        txtSenha = new javax.swing.JPasswordField();
        btnExibirGrade = new javax.swing.JButton();
        cmbDepartamento = new javax.swing.JComboBox<>();
        cmbCurso = new javax.swing.JComboBox<>();
        jPanel2 = new javax.swing.JPanel();
        jScrollPane1 = new javax.swing.JScrollPane();
        tblAvaliacoes = new javax.swing.JTable();
        btnExcluir = new javax.swing.JButton();
        btnEditAvaliacao = new javax.swing.JButton();

        jPasswordField1.setText("jPasswordField1");

        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
        setTitle("Perfil");
        setIconImage(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-aluno/user-aluno.png")).getImage());
        setResizable(false);

        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Perfil Aluno", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Malgun Gothic", 1, 18))); // NOI18N
        jPanel1.setToolTipText("Perfil do Aluno");

        jLabel1.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-aluno/user-aluno.png"))); // NOI18N

        lblNome.setFont(new java.awt.Font("Malgun Gothic", 1, 14)); // NOI18N
        lblNome.setText("Nome");

        lblCurso.setFont(new java.awt.Font("Malgun Gothic", 1, 14)); // NOI18N
        lblCurso.setText("Curso");

        lblMatricula.setFont(new java.awt.Font("Malgun Gothic", 1, 14)); // NOI18N
        lblMatricula.setText("Matrícula");

        txtNome.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtNomeActionPerformed(evt);
            }
        });

        txtMatricula.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtMatriculaActionPerformed(evt);
            }
        });

        btnEditar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-aluno/novo.png"))); // NOI18N
        btnEditar.setText("Editar");
        btnEditar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditarActionPerformed(evt);
            }
        });

        btnCancelar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-aluno/user-cancelar.png"))); // NOI18N
        btnCancelar.setText("Cancelar");
        btnCancelar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCancelarActionPerformed(evt);
            }
        });

        btnSalvarEdicao.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-aluno/user-salvar.png"))); // NOI18N
        btnSalvarEdicao.setText("Salvar");
        btnSalvarEdicao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnSalvarEdicaoActionPerformed(evt);
            }
        });

        btnNovaAvaliacao.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-avaliacao/nova-avaliacao.png"))); // NOI18N
        btnNovaAvaliacao.setText("Avaliar");
        btnNovaAvaliacao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnNovaAvaliacaoActionPerformed(evt);
            }
        });

        txtDepartamento.setFont(new java.awt.Font("Malgun Gothic", 1, 14)); // NOI18N
        txtDepartamento.setText("Departamento");

        lblEmail.setFont(new java.awt.Font("Malgun Gothic", 1, 14)); // NOI18N
        lblEmail.setText("Email");

        lblSenha.setFont(new java.awt.Font("Malgun Gothic", 1, 14)); // NOI18N
        lblSenha.setText("Senha:");

        txtSenha.setText("jPasswordField2");

        btnExibirGrade.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/disciplina/icone salvar grade.png"))); // NOI18N
        btnExibirGrade.setText("Exibir grade");
        btnExibirGrade.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExibirGradeActionPerformed(evt);
            }
        });

        cmbDepartamento.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        cmbCurso.setModel(new javax.swing.DefaultComboBoxModel<>(new String[] { "Item 1", "Item 2", "Item 3", "Item 4" }));

        javax.swing.GroupLayout jPanel1Layout = new javax.swing.GroupLayout(jPanel1);
        jPanel1.setLayout(jPanel1Layout);
        jPanel1Layout.setHorizontalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addContainerGap(29, Short.MAX_VALUE)
                        .addComponent(btnNovaAvaliacao)
                        .addGap(211, 211, 211)
                        .addComponent(btnExibirGrade)
                        .addGap(18, 18, 18)
                        .addComponent(btnEditar)
                        .addGap(18, 18, 18)
                        .addComponent(btnCancelar))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(40, 40, 40)
                        .addComponent(jLabel1)
                        .addGap(60, 60, 60)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(txtDepartamento)
                            .addComponent(lblCurso)
                            .addComponent(lblNome)
                            .addComponent(txtNome, javax.swing.GroupLayout.PREFERRED_SIZE, 242, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lblEmail)
                            .addComponent(lblSenha)
                            .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                                .addComponent(txtSenha, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, 153, Short.MAX_VALUE)
                                .addComponent(txtEmail, javax.swing.GroupLayout.Alignment.LEADING))
                            .addComponent(cmbDepartamento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(cmbCurso, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txtMatricula, javax.swing.GroupLayout.PREFERRED_SIZE, 91, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lblMatricula)
                    .addComponent(btnSalvarEdicao))
                .addGap(28, 28, 28))
        );
        jPanel1Layout.setVerticalGroup(
            jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel1Layout.createSequentialGroup()
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(14, 14, 14)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lblNome)
                            .addComponent(lblMatricula))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(txtNome, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(txtMatricula, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(lblCurso)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cmbCurso, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(21, 21, 21)
                        .addComponent(txtDepartamento)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(cmbDepartamento, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(lblEmail)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                        .addComponent(txtEmail, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addGap(18, 18, 18)
                        .addComponent(lblSenha)
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                        .addComponent(txtSenha, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(jLabel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addGroup(jPanel1Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(btnSalvarEdicao)
                            .addComponent(btnCancelar)
                            .addComponent(btnEditar)
                            .addComponent(btnNovaAvaliacao, javax.swing.GroupLayout.PREFERRED_SIZE, 56, javax.swing.GroupLayout.PREFERRED_SIZE)))
                    .addGroup(jPanel1Layout.createSequentialGroup()
                        .addGap(33, 33, 33)
                        .addComponent(btnExibirGrade, javax.swing.GroupLayout.DEFAULT_SIZE, 52, Short.MAX_VALUE)))
                .addContainerGap())
        );

        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Minhas Avaliações", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Malgun Gothic", 1, 18))); // NOI18N

        tblAvaliacoes.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null},
                {null, null, null, null}
            },
            new String [] {
                "id", "Professor (a)", "Feedback", "Nota"
            }
        ) {
            boolean[] canEdit = new boolean [] {
                false, false, false, false
            };

            public boolean isCellEditable(int rowIndex, int columnIndex) {
                return canEdit [columnIndex];
            }
        });
        tblAvaliacoes.setToolTipText("");
        tblAvaliacoes.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tblAvaliacoesMouseClicked(evt);
            }
        });
        jScrollPane1.setViewportView(tblAvaliacoes);

        btnExcluir.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-avaliacao/excluir-avaliacao.png"))); // NOI18N
        btnExcluir.setText("Excluir");
        btnExcluir.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnExcluirActionPerformed(evt);
            }
        });

        btnEditAvaliacao.setIcon(new javax.swing.ImageIcon(getClass().getResource("/imagens/img-avaliacao/editar-avaliacao.png"))); // NOI18N
        btnEditAvaliacao.setText("Editar");
        btnEditAvaliacao.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnEditAvaliacaoActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout jPanel2Layout = new javax.swing.GroupLayout(jPanel2);
        jPanel2.setLayout(jPanel2Layout);
        jPanel2Layout.setHorizontalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, jPanel2Layout.createSequentialGroup()
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addComponent(btnEditAvaliacao)
                .addGap(30, 30, 30)
                .addComponent(btnExcluir)
                .addGap(26, 26, 26))
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jScrollPane1, javax.swing.GroupLayout.DEFAULT_SIZE, 904, Short.MAX_VALUE)
                .addContainerGap())
        );
        jPanel2Layout.setVerticalGroup(
            jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel2Layout.createSequentialGroup()
                .addGroup(jPanel2Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btnExcluir)
                    .addComponent(btnEditAvaliacao))
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jScrollPane1, javax.swing.GroupLayout.PREFERRED_SIZE, 445, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 0, Short.MAX_VALUE))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addContainerGap())))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(jPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(jPanel2, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                .addContainerGap())
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void btnNovaAvaliacaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnNovaAvaliacaoActionPerformed
        this.limpar();
        this.setVisible(false);
        new TelaAvaliacao(aluno.getMatricula(), this.aluno).setVisible(true);
        //carregarTabelaAvaliacao();
    }//GEN-LAST:event_btnNovaAvaliacaoActionPerformed

    private void btnExcluirActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExcluirActionPerformed
        
        if(tblAvaliacoes.getSelectedRow() != -1){
            
            Avaliacao avalia = new Avaliacao();
            AlunoDAO dao = new AlunoDAO();
            
            avalia.setId((int) tblAvaliacoes.getValueAt(tblAvaliacoes.getSelectedRow(), 0));
            
            dao.delete(avalia);
            
            // Remover a linha do modelo da tabela
            DefaultTableModel modelo = (DefaultTableModel) tblAvaliacoes.getModel();
            modelo.removeRow(tblAvaliacoes.getSelectedRow());
        }
        else{
            JOptionPane.showMessageDialog(null, "Selecione uma avaliação para excluir.");
        }
        
    }//GEN-LAST:event_btnExcluirActionPerformed

    private void btnSalvarEdicaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnSalvarEdicaoActionPerformed
 
        String nome = this.txtNome.getText();
        String curso = (String) this.cmbCurso.getSelectedItem();
        String email = this.txtEmail.getText();
        String senha = this.txtSenha.getText();
        String departamento = (String) this.cmbDepartamento.getSelectedItem();
        String matricula = this.txtMatricula.getText();
        if (cmbDepartamento.getSelectedIndex()==0){
            JOptionPane.showMessageDialog(null, "Selecione um departamento!");
        }
        else if (cmbCurso.getSelectedIndex()==0){
            JOptionPane.showMessageDialog(null, "Selecione um curso!");            
        }
        else{
            AlunoDAO dao = new AlunoDAO();
            Aluno aluno = new Aluno(this.aluno.getId(), nome, departamento, email, matricula, curso, senha);
            this.setAluno(aluno);
            dao.update(aluno);
            this.limpar();
            this.habilitarBtn(true, true, false, false, true, true, true);
        }
        
    }//GEN-LAST:event_btnSalvarEdicaoActionPerformed
 
    
    private void btnCancelarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCancelarActionPerformed
        //cancela a acao atual e volta para estado inicial da pagina, com todos os campos limpos
        this.limpar();
        this.habilitarBtn(true, true, false, false, false, true, true);
        this.habilitarTexto(false, false, false, false, false, false);
        btnExibirGrade.setVisible(true);
        btnExibirGrade.setEnabled(true);
        //carregarTabelaAvaliacao();
    }//GEN-LAST:event_btnCancelarActionPerformed

    private void btnEditarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditarActionPerformed
        //apenas habilita botoes e campos de texto para que os dados sejam inseridos
        this.txtNome.setText(this.aluno.getNome());
        this.txtEmail.setText(this.aluno.getEmail());
        int indiceCurso = this.achaCurso(this.aluno.getCurso());
        this.cmbCurso.setSelectedIndex(indiceCurso);
        String departamentoAluno= this.aluno.getDepartamento();
        int indiceDepartamento = this.achaDepartamento(departamentoAluno);
        this.cmbDepartamento.setSelectedIndex(indiceDepartamento);
        this.txtSenha.setText(this.aluno.getSenha());
        this.txtMatricula.setText(this.aluno.getMatricula());
        this.habilitarTexto(true, true, true, false, true, true);
        this.habilitarBtn(false, false, true, true, false, false, false);
        btnExibirGrade.setVisible(false);
        btnExibirGrade.setEnabled(false);
        this.txtNome.requestFocus();
        //carregarTabelaAvaliacao();
    }//GEN-LAST:event_btnEditarActionPerformed

    private void txtMatriculaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtMatriculaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtMatriculaActionPerformed

    private void txtNomeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtNomeActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtNomeActionPerformed

    private void tblAvaliacoesMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tblAvaliacoesMouseClicked
        int i = tblAvaliacoes.getSelectedRow();
        if(i>=0 && i<aluno.getAvaliacoes().size()){
            Avaliacao avalia = aluno.getAvaliacoes().get(i);
        }
        this.habilitarBtn(true, false, true, false, true, false, true);
        
    }//GEN-LAST:event_tblAvaliacoesMouseClicked

    private void btnEditAvaliacaoActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnEditAvaliacaoActionPerformed
         if(tblAvaliacoes.getSelectedRow() != -1){
            AvaliacaoDAO dao = new AvaliacaoDAO();
             
            String feedback = (String) tblAvaliacoes.getValueAt(tblAvaliacoes.getSelectedRow(), 2);
            int id = (int) tblAvaliacoes.getValueAt(tblAvaliacoes.getSelectedRow(), 0);
            Professor professor = dao.buscarProfessor((String) tblAvaliacoes.getValueAt(tblAvaliacoes.getSelectedRow(), 1));
            float nota = (float)tblAvaliacoes.getValueAt(tblAvaliacoes.getSelectedRow(), 3);
            
            Avaliacao avalia = new Avaliacao(id, professor, this.aluno, feedback, nota);            
            dao.update(avalia);
            
            // Remover a linha do modelo da tabela
            DefaultTableModel modelo = (DefaultTableModel) tblAvaliacoes.getModel();
            modelo.removeRow(tblAvaliacoes.getSelectedRow());
        }
        else{
            JOptionPane.showMessageDialog(null, "Selecione uma avaliação para excluir.");
        }
    }//GEN-LAST:event_btnEditAvaliacaoActionPerformed

    private void btnExibirGradeActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnExibirGradeActionPerformed
        this.setVisible(false);
        new telaGrade(this.getAluno()).setVisible(true);              // TODO add your handling code here:
    }//GEN-LAST:event_btnExibirGradeActionPerformed

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        
        /* Set the Nimbus look and feel */
        //<editor-fold defaultstate="collapsed" desc=" Look and feel setting code (optional) ">
        /* If Nimbus (introduced in Java SE 6) is not available, stay with the default look and feel.
         * For details see http://download.oracle.com/javase/tutorial/uiswing/lookandfeel/plaf.html 
         */
        try {
            for (javax.swing.UIManager.LookAndFeelInfo info : javax.swing.UIManager.getInstalledLookAndFeels()) {
                if ("Nimbus".equals(info.getName())) {
                    javax.swing.UIManager.setLookAndFeel(info.getClassName());
                    break;
                }
            }
        } catch (ClassNotFoundException ex) {
            java.util.logging.Logger.getLogger(TelaAluno.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (InstantiationException ex) {
            java.util.logging.Logger.getLogger(TelaAluno.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (IllegalAccessException ex) {
            java.util.logging.Logger.getLogger(TelaAluno.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        } catch (javax.swing.UnsupportedLookAndFeelException ex) {
            java.util.logging.Logger.getLogger(TelaAluno.class.getName()).log(java.util.logging.Level.SEVERE, null, ex);
        }
        //</editor-fold>

        /* Create and display the form */
        java.awt.EventQueue.invokeLater(new Runnable() {
            public void run() {
                new TelaAluno().setVisible(true);
            }
        });
        
             
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnCancelar;
    private javax.swing.JButton btnEditAvaliacao;
    private javax.swing.JButton btnEditar;
    private javax.swing.JButton btnExcluir;
    private javax.swing.JButton btnExibirGrade;
    private javax.swing.JButton btnNovaAvaliacao;
    private javax.swing.JButton btnSalvarEdicao;
    private javax.swing.JComboBox<String> cmbCurso;
    private javax.swing.JComboBox<String> cmbDepartamento;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel2;
    private javax.swing.JPasswordField jPasswordField1;
    private javax.swing.JScrollPane jScrollPane1;
    private javax.swing.JLabel lblCurso;
    private javax.swing.JLabel lblEmail;
    private javax.swing.JLabel lblMatricula;
    private javax.swing.JLabel lblNome;
    private javax.swing.JLabel lblSenha;
    private javax.swing.JTable tblAvaliacoes;
    private javax.swing.JLabel txtDepartamento;
    private javax.swing.JTextField txtEmail;
    private javax.swing.JTextField txtMatricula;
    private javax.swing.JTextField txtNome;
    private javax.swing.JPasswordField txtSenha;
    // End of variables declaration//GEN-END:variables
}
